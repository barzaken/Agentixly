{
  "name": "ai-chat-input",
  "type": "registry:ui",
  "dependencies": [
    "lucide-react",
    "framer-motion"
  ],
  "registryDependencies": [],
  "files": [
    {
      "path": "ai-chat-input.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { Paperclip, ArrowUp, X, ChevronDown, Mic, Globe, Sparkles } from \"lucide-react\"\nimport { motion, AnimatePresence } from \"framer-motion\"\nimport { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\n// --- Utility ---\nfunction cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n\n// --- Constants ---\nconst MODELS = [\n  { id: \"gpt-4o\", name: \"GPT-4o\", icon: \"https://cdn.brandfetch.io/idR3duQxYl/theme/dark/symbol.svg?c=1bxid64Mup7aczewSAYMX&t=1749527471692\" },\n  { id: \"claude-3-5\", name: \"Claude 3.5\", icon: \"https://cdn.brandfetch.io/idW5s392j1/w/338/h/338/theme/dark/icon.png?c=1bxid64Mup7aczewSAYMX&t=1738315794862\" },\n  { id: \"gemini-pro\", name: \"Gemini Pro\", icon: \"https://cdn.brandfetch.io/id6O2oGzv-/theme/dark/symbol.svg?c=1bxid64Mup7aczewSAYMX&t=1755835725776\" },\n]\n\n// --- Component ---\ninterface SmartAiInputProps {\n  onSend: (message: string, files: File[], model: string) => void\n  disabled?: boolean\n}\n\nexport default function SmartAiInput({ onSend, disabled }: SmartAiInputProps) {\n  const [value, setValue] = React.useState(\"\")\n  const [files, setFiles] = React.useState<File[]>([])\n  const [selectedModel, setSelectedModel] = React.useState(MODELS[0])\n  \n  // State for UI behavior\n  const [isExpanded, setIsExpanded] = React.useState(false)\n  const [showModelMenu, setShowModelMenu] = React.useState(false)\n  const [isOverflowVisible, setIsOverflowVisible] = React.useState(false) // Fix for dropdown clipping\n  \n  const containerRef = React.useRef<HTMLDivElement>(null)\n  const textareaRef = React.useRef<HTMLTextAreaElement>(null)\n  const fileInputRef = React.useRef<HTMLInputElement>(null)\n\n  // 1. Handle Click Outside (Collapse input & Close Menu)\n  React.useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\n        // Close menu if open\n        setShowModelMenu(false)\n        \n        // Collapse input only if empty\n        if (!value.trim() && files.length === 0) {\n          setIsExpanded(false)\n          setIsOverflowVisible(false)\n        }\n      }\n    }\n    document.addEventListener(\"mousedown\", handleClickOutside)\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside)\n  }, [value, files])\n\n  // 2. Auto-resize textarea\n  React.useEffect(() => {\n    if (textareaRef.current) {\n      textareaRef.current.style.height = \"auto\"\n      textareaRef.current.style.height = `${Math.min(textareaRef.current.scrollHeight, 280)}px`\n    }\n  }, [value])\n\n  const handleSend = () => {\n    if ((!value.trim() && files.length === 0) || disabled) return\n    onSend(value, files, selectedModel.id)\n    setValue(\"\")\n    setFiles([])\n    // We keep it expanded after send for better UX, or you can collapse it:\n    // setIsExpanded(false)\n  }\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault()\n      handleSend()\n    }\n    if (e.key === \"Escape\") {\n      setShowModelMenu(false)\n      if (!value.trim()) setIsExpanded(false)\n      textareaRef.current?.blur()\n    }\n  }\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files) {\n      setFiles((prev) => [...prev, ...Array.from(e.target.files || [])])\n      setIsExpanded(true)\n    }\n  }\n\n  return (\n    <div className=\"w-full max-w-2xl mx-auto p-6 font-sans antialiased\">\n      <div\n        ref={containerRef}\n        className={cn(\n          \"relative flex flex-col w-full rounded-[26px] transition-all duration-300 ease-[cubic-bezier(0.25,1,0.5,1)] border\",\n          isExpanded\n            ? \"bg-white dark:bg-[#1a1a1a] border-black/5 dark:border-white/10 shadow-xl shadow-black/5\"\n            : \"bg-[#f4f4f4] dark:bg-[#222] border-transparent hover:bg-[#efefef] dark:hover:bg-[#2a2a2a]\"\n        )}\n      >\n        {/* --- Top Section: Model Selector --- */}\n        <AnimatePresence>\n          {isExpanded && (\n            <motion.div\n              initial={{ height: 0, opacity: 0 }}\n              animate={{ height: \"auto\", opacity: 1 }}\n              exit={{ height: 0, opacity: 0 }}\n              onAnimationComplete={() => setIsOverflowVisible(true)} // Enable overflow after animation\n              className={cn(\n                \"w-full\",\n                isOverflowVisible ? \"overflow-visible\" : \"overflow-hidden\"\n              )}\n            >\n              <div className=\"px-3 pt-3 relative\">\n                <button\n                  onClick={() => setShowModelMenu(!showModelMenu)}\n                  className=\"flex items-center gap-1.5 px-2 py-1.5 rounded-full text-[11px] font-medium bg-white dark:bg-black/20 border border-black/5 dark:border-white/5 text-zinc-600 dark:text-zinc-300 hover:text-zinc-900 dark:hover:text-white transition-colors\"\n                >\n                  <img \n                    src={selectedModel.icon} \n                    alt=\"\" \n                    className=\"w-3.5 h-3.5 rounded-full object-cover opacity-90\"\n                  />\n                  <span>{selectedModel.name}</span>\n                  <ChevronDown className=\"w-3 h-3 opacity-40\" />\n                </button>\n\n                {/* Dropdown Menu */}\n                <AnimatePresence>\n                  {showModelMenu && (\n                    <motion.div\n                      initial={{ opacity: 0, y: 4, scale: 0.98 }}\n                      animate={{ opacity: 1, y: 0, scale: 1 }}\n                      exit={{ opacity: 0, y: 4, scale: 0.98 }}\n                      transition={{ duration: 0.1 }}\n                      className=\"absolute left-3 top-12 z-50 w-44 p-1 bg-white dark:bg-[#1a1a1a] border border-black/5 dark:border-white/10 rounded-xl shadow-lg shadow-black/5\"\n                    >\n                      {MODELS.map((model) => (\n                        <button\n                          key={model.id}\n                          onClick={() => {\n                            setSelectedModel(model)\n                            setShowModelMenu(false)\n                          }}\n                          className={cn(\n                            \"flex items-center gap-2 w-full px-2 py-1.5 text-xs rounded-lg transition-colors\",\n                            selectedModel.id === model.id\n                              ? \"bg-zinc-100 dark:bg-zinc-800 text-zinc-900 dark:text-zinc-100 font-medium\"\n                              : \"text-zinc-500 dark:text-zinc-400 hover:bg-zinc-50 dark:hover:bg-white/5\"\n                          )}\n                        >\n                           <img \n                            src={model.icon} \n                            className=\"w-3.5 h-3.5 rounded-full opacity-80\" \n                           />\n                          {model.name}\n                        </button>\n                      ))}\n                    </motion.div>\n                  )}\n                </AnimatePresence>\n              </div>\n            </motion.div>\n          )}\n        </AnimatePresence>\n\n        {/* --- Middle: Files & Input --- */}\n        <div className=\"flex flex-col\">\n           {/* Attached Files */}\n           <AnimatePresence>\n            {files.length > 0 && (\n              <motion.div\n                initial={{ height: 0, opacity: 0 }}\n                animate={{ height: \"auto\", opacity: 1 }}\n                exit={{ height: 0, opacity: 0 }}\n                className=\"px-4 overflow-hidden\"\n              >\n                <div className=\"flex flex-wrap gap-2 pt-2 pb-1\">\n                  {files.map((file, i) => (\n                    <div key={i} className=\"flex items-center gap-2 bg-white dark:bg-zinc-800 border border-black/5 dark:border-white/5 pl-2 pr-1.5 py-1 rounded-md text-[10px] text-zinc-600 dark:text-zinc-300 shadow-sm\">\n                      <span className=\"truncate max-w-[100px]\">{file.name}</span>\n                      <button onClick={() => setFiles(prev => prev.filter((_, idx) => idx !== i))} className=\"p-0.5 hover:bg-black/5 dark:hover:bg-white/10 rounded-sm transition-colors\">\n                        <X className=\"w-3 h-3 text-zinc-400 hover:text-red-500\" />\n                      </button>\n                    </div>\n                  ))}\n                </div>\n              </motion.div>\n            )}\n          </AnimatePresence>\n          \n          {/* Main Textarea */}\n          <div className=\"relative px-4 py-3\">\n            <textarea\n              ref={textareaRef}\n              value={value}\n              disabled={disabled}\n              onClick={() => { setIsExpanded(true); setIsOverflowVisible(true); }}\n              onFocus={() => { setIsExpanded(true); setIsOverflowVisible(true); }}\n              onChange={(e) => setValue(e.target.value)}\n              onKeyDown={handleKeyDown}\n              placeholder={isExpanded ? `Ask ${selectedModel.name} anything...` : \"How can I help you?\"}\n              rows={1}\n              className={cn(\n                \"w-full bg-transparent border-none resize-none focus:ring-0 focus:outline-none px-0 py-0 min-h-[24px] max-h-[280px] custom-scrollbar\",\n                \"text-[16px] leading-relaxed text-zinc-900 dark:text-zinc-100\",\n                \"placeholder:text-zinc-500 dark:placeholder:text-zinc-500\",\n                !isExpanded && \"cursor-text\"\n              )}\n            />\n          </div>\n        </div>\n\n        {/* --- Bottom: Actions Toolbar --- */}\n        <AnimatePresence>\n          {isExpanded && (\n            <motion.div\n              initial={{ height: 0, opacity: 0 }}\n              animate={{ height: \"auto\", opacity: 1 }}\n              exit={{ height: 0, opacity: 0 }}\n              className=\"overflow-hidden\"\n            >\n              <div className=\"flex items-center justify-between px-3 pb-3\">\n                {/* Left Actions */}\n                <div className=\"flex items-center gap-1\">\n                  <input type=\"file\" multiple className=\"hidden\" ref={fileInputRef} onChange={handleFileChange} />\n                  <TooltipButton \n                    icon={<Paperclip className=\"w-4 h-4\" />} \n                    label=\"Attach\"\n                    onClick={() => fileInputRef.current?.click()} \n                  />\n                  <TooltipButton \n                    icon={<Globe className=\"w-4 h-4\" />} \n                    label=\"Search\"\n                    onClick={() => {}} \n                  />\n                </div>\n\n                {/* Right Action: Send */}\n                <div className=\"flex items-center\">\n                  <AnimatePresence mode=\"wait\">\n                    {(value.trim() || files.length > 0) ? (\n                      <motion.button\n                        key=\"send\"\n                        initial={{ scale: 0.8, opacity: 0 }}\n                        animate={{ scale: 1, opacity: 1 }}\n                        exit={{ scale: 0.8, opacity: 0 }}\n                        whileTap={{ scale: 0.95 }}\n                        onClick={handleSend}\n                        className=\"flex items-center justify-center w-8 h-8 bg-black dark:bg-white text-white dark:text-black rounded-full shadow-md hover:opacity-90 transition-opacity\"\n                      >\n                        <ArrowUp className=\"w-4 h-4\" strokeWidth={3} />\n                      </motion.button>\n                    ) : (\n                      <motion.button\n                        key=\"mic\"\n                        initial={{ scale: 0.8, opacity: 0 }}\n                        animate={{ scale: 1, opacity: 1 }}\n                        exit={{ scale: 0.8, opacity: 0 }}\n                        className=\"flex items-center justify-center w-8 h-8 rounded-full bg-zinc-100 dark:bg-zinc-800 hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors\"\n                      >\n                         <Mic className=\"w-4 h-4 text-zinc-500 dark:text-zinc-400\" />\n                      </motion.button>\n                    )}\n                  </AnimatePresence>\n                </div>\n              </div>\n            </motion.div>\n          )}\n        </AnimatePresence>\n      </div>\n    </div>\n  )\n}\n\n// --- Minimal Tooltip Button Helper ---\nfunction TooltipButton({ icon, onClick, label }: { icon: React.ReactNode; onClick: () => void; label: string }) {\n  return (\n    <button\n      onClick={onClick}\n      className=\"group relative p-2 text-zinc-400 hover:bg-zinc-100 dark:hover:bg-zinc-800 hover:text-zinc-600 dark:hover:text-zinc-200 rounded-xl transition-all duration-200\"\n      aria-label={label}\n    >\n      {icon}\n    </button>\n  )\n}",
      "type": "registry:ui"
    }
  ]
}